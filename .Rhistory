c(2, -2) / sqrt(36)
c(2, -2) / sqrt(360)
c(2, -2) / sqrt(1000)
library(fma)
ibmclose %>% ggtsdisplay(main="")
ibmclose %>% diff() %>% ggtsdisplay(main="")
y <- ts(numeric(100))
e <- rnorm(100)
for(i in 2:100)
y[i] <- 0.6*y[i-1] + e[i]
sim1 <- ts(e)
sim1 %>% autoplot()
y <- ts(numeric(100))
e <- rnorm(100)
for(i in 2:100)
y[i] <- 0.1*y[i-1] + e[i]
sim2 <- ts(e)
sim2 %>% autoplot()
y <- ts(numeric(100))
e <- rnorm(100)
for(i in 2:100)
y[i] <- 1.0*y[i-1] + e[i]
sim3 <- ts(e)
sim3 %>% autoplot()
y <- ts(numeric(100))
e <- rnorm(100, sd = 1)
e[1] <- 0
for(i in 2:100)
y[i] <- 0.6*e[i-1] + e[i]
sim_c <- ts(e)
sim_c %>% autoplot()
library(ggfortify)
library(openxlsx)
library(fpp2)
library(fma)
library(gridExtra)
library(seasonal)
library(ggplot2)
library(patchwork)
library(caret)
library(grid)
#help function for each series using question mark "??"
??gold
#help function for each series using question mark "??"
??woolyrnq
#help function for each series using question mark "??"
??gas
#autoplots of each series
grid.arrange(autoplot(gold),autoplot(woolyrnq),autoplot(gas))
#frequency of each series
frequency(gold)
frequency(woolyrnq)
frequency(gas)
paste0("The frequency for the gold time series is: ", frequency(gold), "  - where the data represents an ANNUAL observations.")
paste0("The frequency for wool production time series is: ", frequency(woolyrnq), " - where the data represents QUARTERLY observations.")
paste0("The frequency for gas production time series is: ",  frequency(gas), " - where the data represents MONTHLY observations.")
#calling which.max() function
which.max(gold)
#printing maximum value
gold[which.max(gold)]
retaildata <- read.xlsx("https://otexts.com/fpp2/extrafiles/retail.xlsx",startRow = 2)
myts <- ts(retaildata[,"A3349873A"],
frequency=12, start=c(1982,4))
#myts  #code is silent because it represents an example - see "myts2"
myts2 <- ts(retaildata[,"A3349791W"],
frequency=12, start=c(1982,4))
myts2
#time series qutoplot
autoplot(myts2)
#time series seasonal plot
ggseasonplot(myts2)
#time series sub series plot
ggsubseriesplot(myts2)
#time series lag plot
gglagplot(myts2)
#time series ACF
ggAcf(myts2)
#autoplot(), ggseasonplot(), ggsubseriesplot(), gglagplot(), ggAcf()
p1 <- autoplot(plastics)
p2 <- ggseasonplot(plastics)
p3 <- ggsubseriesplot(plastics)
p4 <- gglagplot(plastics)
p5 <- ggAcf(plastics)
grid.arrange(p1,p2,p3,p5,p4, ncol=1)
#multiplicative decomposition
decomp_plastics <- plastics %>%
decompose(type = "multiplicative")
decomp_plastics %>% autoplot()
autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted")
#autoplot(), ggseasonplot(), ggsubseriesplot(), gglagplot(), ggAcf()
p1 <- autoplot(plastics)
p2 <- ggseasonplot(plastics)
p3 <- ggsubseriesplot(plastics)
p4 <- gglagplot(plastics)
p5 <- ggAcf(plastics)
p1 / p2 / p3 / p5 / p4  ncol=1)
#autoplot(), ggseasonplot(), ggsubseriesplot(), gglagplot(), ggAcf()
p1 <- autoplot(plastics)
p2 <- ggseasonplot(plastics)
p3 <- ggsubseriesplot(plastics)
p4 <- gglagplot(plastics)
p5 <- ggAcf(plastics)
p1 / p2 / p3 / p5 / p4
#autoplot(), ggseasonplot(), ggsubseriesplot(), gglagplot(), ggAcf()
p1 <- autoplot(plastics)
p2 <- ggseasonplot(plastics)
p3 <- ggsubseriesplot(plastics)
p4 <- gglagplot(plastics)
p5 <- ggAcf(plastics)
p1 / p2 / p3 / p5
p4
p4
doPlots <- function(Glass, fun, ii, ncol=3) {
pp <- list()
for (i in ii) {
p <- fun(Glass=Glass, i=i)
pp <- c(pp, list(p))
}
do.call("grid.arrange", c(pp, ncol=ncol))
}
plotDen <- function(Glass, i){
data <- data.frame(x=Glass[[i]], type = Glass$Type)
df <- as.data.frame(mean(data$x))
colnames(df) <- "mean"
df$median <- median(data$x)
p <- ggplot(data= data) +
geom_line(aes(x = x), stat = 'density', size = 1,alpha = 1.0) +
xlab(paste0((colnames(Glass)[i]), '\n',
'Skewness: ',round(skewness(Glass[[i]], na.rm = TRUE), 4), '\n',
'Mean: ', round(df$mean, 4), '\n',
'Median: ', round(df$median, 4))) +
theme_light() +
geom_vline(data=df, aes(xintercept=df$mean), linetype = "dashed", size=1, colour="red") +
geom_vline(data=df, aes(xintercept=df$median), size = 1, colour="blue")
return(p)
}
doPlots(Glass, plotDen, ii=1:9, ncol=2)
doPlots <- function(Glass, fun, ii, ncol=3) {
pp <- list()
for (i in ii) {
p <- fun(Glass=Glass, i=i)
pp <- c(pp, list(p))
}
do.call("grid.arrange", c(pp, ncol=ncol))
}
plotDen <- function(Glass, i){
data <- data.frame(x=Glass[[i]], type = Glass$Type)
df <- as.data.frame(mean(data$x))
colnames(df) <- "mean"
df$median <- median(data$x)
p <- ggplot(data= data) +
geom_line(aes(x = x), stat = 'density', size = 1,alpha = 1.0) +
xlab(paste0((colnames(Glass)[i]), '\n',
'Skewness: ',round(skewness(Glass[[i]], na.rm = TRUE), 4), '\n',
'Mean: ', round(df$mean, 4), '\n',
'Median: ', round(df$median, 4))) +
theme_light() +
geom_vline(data=df, aes(xintercept=df$mean), linetype = "dashed", size=1, colour="red") +
geom_vline(data=df, aes(xintercept=df$median), size = 1, colour="blue")
return(p)
}
doPlots(Glass, plotDen, ii=1:9, ncol=2)
library(moments)
library(gridExtra)
doPlots <- function(Glass, fun, ii, ncol=3) {
pp <- list()
for (i in ii) {
p <- fun(Glass=Glass, i=i)
pp <- c(pp, list(p))
}
do.call("grid.arrange", c(pp, ncol=ncol))
}
plotDen <- function(Glass, i){
data <- data.frame(x=Glass[[i]], type = Glass$Type)
df <- as.data.frame(mean(data$x))
colnames(df) <- "mean"
df$median <- median(data$x)
p <- ggplot(data= data) +
geom_line(aes(x = x), stat = 'density', size = 1,alpha = 1.0) +
xlab(paste0((colnames(Glass)[i]), '\n',
'Skewness: ',round(skewness(Glass[[i]], na.rm = TRUE), 4), '\n',
'Mean: ', round(df$mean, 4), '\n',
'Median: ', round(df$median, 4))) +
theme_light() +
geom_vline(data=df, aes(xintercept=df$mean), linetype = "dashed", size=1, colour="red") +
geom_vline(data=df, aes(xintercept=df$median), size = 1, colour="blue")
return(p)
}
doPlots(Glass, plotDen, ii=1:9, ncol=2)
library(moments)
library(gridExtra)
doPlots <- function(Glass, fun, ii, ncol=3) {
pp <- list()
for (i in ii) {
p <- fun(Glass=Glass, i=i)
pp <- c(pp, list(p))
}
do.call("grid.arrange", c(pp, ncol=ncol))
}
plotDen <- function(Glass, i){
data <- data.frame(x=Glass[[i]], type = Glass$Type)
df <- as.data.frame(mean(data$x))
colnames(df) <- "mean"
df$median <- median(data$x)
p <- ggplot(data= data) +
geom_line(aes(x = x), stat = 'density', size = 1,alpha = 1.0) +
xlab(paste0((colnames(Glass)[i]), '\n',
'Skewness: ',round(skewness(Glass[[i]], na.rm = TRUE), 4), '\n',
'Mean: ', round(df$mean, 4), '\n',
'Median: ', round(df$median, 4))) +
theme_light() +
geom_vline(data=df, aes(xintercept=df$mean), linetype = "dashed", size=1, colour="red") +
geom_vline(data=df, aes(xintercept=df$median), size = 1, colour="blue")
return(p)
}
doPlots(Glass, plotDen, ii=1:9, ncol=2)
knitr::opts_chunk$set(echo=TRUE, warning=FALSE,
message=FALSE,
collapse = FALSE,
comment = "#>" )
library(ggfortify)
library(openxlsx)
library(fpp2)
library(fma)
library(gridExtra)
library(seasonal)
library(ggplot2)
library(patchwork)
library(caret)
library(grid)
#help function for each series using question mark "??"
??gold
#help function for each series using question mark "??"
??woolyrnq
#help function for each series using question mark "??"
??gas
#autoplots of each series
grid.arrange(autoplot(gold),autoplot(woolyrnq),autoplot(gas))
#frequency of each series
frequency(gold)
frequency(woolyrnq)
frequency(gas)
#calling which.max() function
which.max(gold)
#printing maximum value
gold[which.max(gold)]
retaildata <- read.xlsx("https://otexts.com/fpp2/extrafiles/retail.xlsx",startRow = 2)
myts <- ts(retaildata[,"A3349873A"],
frequency=12, start=c(1982,4))
#myts  #code is silent because it represents an example - see "myts2"
myts2 <- ts(retaildata[,"A3349791W"],
frequency=12, start=c(1982,4))
#time series qutoplot
autoplot(myts2)
#time series seasonal plot
ggseasonplot(myts2)
#time series sub series plot
ggsubseriesplot(myts2)
#autoplot(), ggseasonplot(), ggsubseriesplot(), gglagplot(), ggAcf()
p1 <- autoplot(plastics)
p2 <- ggseasonplot(plastics)
p3 <- ggsubseriesplot(plastics)
p4 <- gglagplot(plastics)
p5 <- ggAcf(plastics)
p1 / p2 / p3 / p5
p4
#multiplicative decomposition
decomp_plastics <- plastics %>%
decompose(type = "multiplicative")
decomp_plastics %>% autoplot()
autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted")
plasticsOutlier <- plasticsplasticsOutlier[30] <- plasticsOutlier[30] + 500autoplot(plasticsOutlier, series = "Data") +  autolayer(trendcycle(fit), series = "Trend") +  autolayer(seasadj(fit), series = "Seasonally Adjusted") +   xlab("Year") + ylab("Monthly Sales (in thousands)") +  ggtitle("Seasonally Adjusted Plastics Manufacturer Sales Data") +  scale_color_manual(values = c("blue", "green", "red"),                     breaks = c("Data", "Trend", "Seasonally Adjusted"))
plasticsOutlier <- plastics
knitr::opts_chunk$set(echo=TRUE, warning=FALSE,
message=FALSE,
collapse = FALSE,
comment = "#>" )
library(ggfortify)
library(openxlsx)
library(fpp2)
library(fma)
library(gridExtra)
library(seasonal)
library(ggplot2)
library(patchwork)
library(caret)
library(grid)
#help function for each series using question mark "??"
??gold
#help function for each series using question mark "??"
??woolyrnq
#help function for each series using question mark "??"
??gas
#autoplots of each series
grid.arrange(autoplot(gold),autoplot(woolyrnq),autoplot(gas))
#frequency of each series
frequency(gold)
frequency(woolyrnq)
frequency(gas)
#calling which.max() function
which.max(gold)
#printing maximum value
gold[which.max(gold)]
retaildata <- read.xlsx("https://otexts.com/fpp2/extrafiles/retail.xlsx",startRow = 2)
myts <- ts(retaildata[,"A3349873A"],
frequency=12, start=c(1982,4))
#myts  #code is silent because it represents an example - see "myts2"
myts2 <- ts(retaildata[,"A3349791W"],
frequency=12, start=c(1982,4))
#time series qutoplot
autoplot(myts2)
#time series seasonal plot
ggseasonplot(myts2)
#time series sub series plot
ggsubseriesplot(myts2)
#autoplot(), ggseasonplot(), ggsubseriesplot(), gglagplot(), ggAcf()
p1 <- autoplot(plastics)
p2 <- ggseasonplot(plastics)
p3 <- ggsubseriesplot(plastics)
p4 <- gglagplot(plastics)
p5 <- ggAcf(plastics)
p1 / p2 / p3 / p5
p4
#multiplicative decomposition
decomp_plastics <- plastics %>%
decompose(type = "multiplicative")
decomp_plastics %>% autoplot()
autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted")
plastics %>% decompose(type = "multiplicative") -> fit
autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted")
plastics %>% decompose(type = "multiplicative") -> fit
autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted")
plastics %>% decompose(type = "multiplicative") -> fit
autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted")
plastics_mid <- plastics
plastics_end <- plastics
plastics_mid[30] <- plastics_mid[30] + 500 #outlier in the middle
plastics_end[52] <- plastics_end[52] + 500 #outlier to reflect "near the end"
decomp_mid <- plastics_mid %>%
decompose(type = "multiplicative")
p <- autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted") +
ggtitle("Plastics Seasonally Adjusted - Original") +
theme(plot.title = element_text(size = 14))
p1 <- autoplot(plastics_mid, series = "Data") +
autolayer(trendcycle(decomp_mid), series = "Trend") +
autolayer(seasadj(decomp_mid), series = "Seasonally Adjusted") +
ggtitle("Plastics Seasonally Adjusted - Mid Observation")+
theme(plot.title = element_text(size = 14))
decomp_end <- plastics_end %>%
decompose(type = "multiplicative")
p2 <- autoplot(plastics_end, series = "Data") +
autolayer(trendcycle(decomp_end), series = "Trend") +
autolayer(seasadj(decomp_end), series = "Seasonally Adjusted") +
ggtitle("Plastics Seasonally Adjusted - Near the End Observation")+
theme(plot.title = element_text(size = 14))
grid.arrange(p, p1,p2)
plastics_mid <- plastics
plastics_end <- plastics
plastics_mid[30] <- plastics_mid[30] + 500 #outlier in the middle
plastics_end[52] <- plastics_end[52] + 500 #outlier to reflect "near the end"
decomp_mid <- plastics_mid %>%
decompose(type = "multiplicative")
p <- autoplot(plastics, series = "Data") +
autolayer(trendcycle(decomp_plastics), series = "Trend") +
autolayer(seasadj(decomp_plastics), series = "Seasonally Adjusted") +
ggtitle("Plastics Seasonally Adjusted - Original") +
theme(plot.title = element_text(size = 14))
p1 <- autoplot(plastics_mid, series = "Data") +
autolayer(trendcycle(decomp_mid), series = "Trend") +
autolayer(seasadj(decomp_mid), series = "Seasonally Adjusted") +
ggtitle("Plastics Seasonally Adjusted - Mid Observation")+
theme(plot.title = element_text(size = 14))
decomp_end <- plastics_end %>%
decompose(type = "multiplicative")
p2 <- autoplot(plastics_end, series = "Data") +
autolayer(trendcycle(decomp_end), series = "Trend") +
autolayer(seasadj(decomp_end), series = "Seasonally Adjusted") +
ggtitle("Plastics Seasonally Adjusted - Near the End Observation")+
theme(plot.title = element_text(size = 14))
grid.arrange(p, p1,p2)
head(plastics)
str(plastics)
#libraries
library(readxl)
library(tidyverse)
library(tidyverse)
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("cli")
install.packages("cli")
install.packages("cli")
#libraries
library(readxl)
library(tidyverse)
library(cli)
#libraries
library(readxl)
library(tidyverse)
#libraries
library(readxl)
library(tidyverse)
#libraries
library(readxl)
library(tidyverse)
#libraries
library(readxl)
library(tidyverse)
df <- read_excel("data.xls")
head(df)
dim(df)
# Factoring category to get a count of the elements within dataset
df$category <- as.factor(df$category)
summary(df)
paste0(sum(is.na(df))," values missing from original set")
# Plots of missing values
aggr_plot <- VIM::aggr(df, col = c("navyblue", "orange"),
numbers = T, sortVars = T,
labels = names(df),
cex.axis = 0.7, gap = 3,
ylab = c("Frequency of Missing Data", "Pattern"))
# Shadow Matrix: correlation of missing values from the dataset
x <- as.data.frame(abs(is.na(df)))
y <- x[which(sapply(x, sd) >0)] # Extracts which variables are missing/NA from the dataset
cor(y) # Tendency of NA when correlated among variables
preProcess_NAdata_model <- preProcess(as.data.frame(df), method ="medianImpute")
summary(df)
# Converting Var02 to Datetime
df$SeriesInd <- as.integer(df$SeriesInd)
df$SeriesInd <- as.POSIXct(df$SeriesInd, origin = "1970-01-01")
# Renaming SeriesInd to Date to clarify purpose
df <- df %>% rename("Datetime" = SeriesInd)
# Converting Var02 to Datetime
df$SeriesInd <- as.integer(df$SeriesInd)
df$SeriesInd <- as.POSIXct(df$SeriesInd, origin = "1970-01-01")
# Renaming SeriesInd to Date to clarify purpose
df <- df %>% rename("Datetime" = SeriesInd)
#libraries
library(readxl)
library(tidyverse)
remove.packages("cli")
install.packages("cli")
install.packages("cli")
#libraries
library(readxl)
library(tidyverse)
install.packages("dplyr")
#libraries
library(readxl)
library(tidyverse)
devtools::install_github("dplyr")
remove.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
install.packages("dplyr")
#libraries
library(readxl)
library(tidyverse)
install.packages("rlang")
install.packages("rlang")
install.packages("rlang")
#libraries
library(readxl)
library(tidyverse)
remove.packages("tidyverse")
remove.packages("rlang")
#libraries
library(readxl)
library(tidyverse)
remove.packages("vctrs")
#libraries
library(readxl)
library(tidyverse)
install.packages("vctrs")
#libraries
library(readxl)
library(tidyverse)
library(ggplot2)
library(patchwork)
library(fpp2)
library(caret)
remove.packages("caret")
remove.packages("glue")
#libraries
library(readxl)
library(tidyverse)
install.packages("glue")
#libraries
library(readxl)
library(tidyverse)
library(ggplot2)
library(patchwork)
library(fpp2)
library(caret)
remove.packages("tibble")
