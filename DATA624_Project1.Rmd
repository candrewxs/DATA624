---
title: "Data624 Project 1"
author: "Esteban Aramayo, Coffy Andrews-Guo, LeTicia Cancel, Joseph Connolly, Ian Costello"
date: '2022-06-13'
output: 
  word_document:
    toc: yes
    toc_depth: '2'
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: 2
---

```{r warning=FALSE}
#libraries
library(readxl)
```




```{r}
df <- read_excel("data.xls")
head(df)
```

## Data Exploration

Summary of each column. Each predictor has NA values but I'm not sure what proportion of the data is NA yet. Column Var02's values differ the most when compared to the other Var## columns. So we will see how that impacts the data.
```{r}
summary(df)
```
Boxplots: Var02 has the most outliers but this is also the column with the largest range in values
```{r warning=FALSE, fig.width=10, fig.height=8}
p1 <- ggplot(df, aes(category, Var01)) +
  geom_boxplot()
p2 <- ggplot(df, aes(category, Var02)) +
  geom_boxplot()
p3 <- ggplot(df, aes(category, Var03)) +
  geom_boxplot()
p4 <- ggplot(df, aes(category, Var05)) +
  geom_boxplot()
p5 <- ggplot(df, aes(category, Var07)) +
  geom_boxplot()

p1+p2+p3+p4+p5+
  plot_layout(ncol = 3)
```

All predictors are left skewed so transformations are needed for each column
```{r warning=FALSE, fig.width=10, fig.height=7}
p1 <- ggplot(df, aes(Var01, color=category)) +
  geom_density()
p2 <- ggplot(df, aes(Var02, color=category)) +
  geom_density()
p3 <- ggplot(df, aes(Var03, color=category)) +
  geom_density()
p4 <- ggplot(df, aes(Var05, color=category)) +
  geom_density()
p5 <- ggplot(df, aes(Var07, color=category)) +
  geom_density()

p1+p2+p3+p4+p5+
  plot_layout(ncol = 2)
```

The NAs make up less than 10% of all values in the data. 
```{r}
aggr(df, col=c('navyblue','yellow'),
     numbers=TRUE, sortVars=TRUE,
     labels=names(df), cex.axis=.7,
     gap=3, ylab=c("Missing data","Pattern"))
```
## Data transformations

Var02 is the most skewed
```{r}
library(moments)
skewness(df$Var01, na.rm = TRUE)
skewness(df$Var02, na.rm = TRUE)
skewness(df$Var03, na.rm = TRUE)
skewness(df$Var05, na.rm = TRUE)
skewness(df$Var07, na.rm = TRUE)
```
Experimenting with 3 different transformations; log, square root, and cube root. The log transformation looks the most normalized
```{r error=FALSE}
log_var01 <- log10(df$Var01)
sqrt_var01 <- sqrt(df$Var01)
cube_var01 <- df$Var01^(1/3)

hist(df$Var01)
hist(log_var01)
hist(sqrt_var01)
hist(cube_var01)


```

Transform all predictors using log transformation
```{r}
df_transformed <- df
df_transformed$Var01 <- log10(df$Var01)
df_transformed$Var02 <- log10(df$Var02)
df_transformed$Var03 <- log10(df$Var03)
df_transformed$Var05 <- log10(df$Var05)
df_transformed$Var07 <- log10(df$Var07)
```

New plots using transformed dataframe. Var02 is the most normalize so I will try different transformations with the other columns
```{r warning=FALSE, fig.width=10, fig.height=7}
p1 <- ggplot(df_transformed, aes(Var01, color=category)) +
  geom_density()
p2 <- ggplot(df_transformed, aes(Var02, color=category)) +
  geom_density()
p3 <- ggplot(df_transformed, aes(Var03, color=category)) +
  geom_density()
p4 <- ggplot(df_transformed, aes(Var05, color=category)) +
  geom_density()
p5 <- ggplot(df_transformed, aes(Var07, color=category)) +
  geom_density()

p1+p2+p3+p4+p5+
  plot_layout(ncol = 2)
```







